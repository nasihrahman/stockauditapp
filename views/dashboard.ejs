<!DOCTYPE html> 
<html lang="en"> 
<head> 
  <meta charset="UTF-8" /> 
  <title>Audit Dashboard</title> 
  <link rel="stylesheet" href="/styles.css" /> 
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/css/dashstyle.css">
</head> 
<body> 
  <header> 
    <div class="logo-placeholder">LOGO</div> 
  </header> 
 <section class="new-company"> 
      <h2>Create New Company</h2> 
      <form id="addCompanyForm"> 
        <input type="text" name="name" id="companyName" placeholder="Company Name" required /> 
        <button class="button-59" role="button" type="submit">Create Company</button> 
      </form> 
    </section> 
  <main class="dashboard"> 
    <section class="company-list-section"> 
      <h2>Companies</h2> 
      <ul id="companyList" class="company-list"> 
        <% companies.forEach(company => { %> 
          <li> 
            <div class="company-info">
              <div class="remark-box"></div>
              <strong><%= company.name %></strong>
            </div>
            <div class="action-buttons">
              <button onclick="openAudit('<%= company._id %>')">View Audit</button>
              <button class="edit-btn" onclick="editCompany('<%= company._id %>')">Edit</button> 
            </div>
          </li> 
        <% }) %> 
      </ul> 
    </section> 
 
    
  </main> 
  
  <footer>
    <button onclick="logout()">Logout</button>
  </footer> 
 
  <script> 
    document.getElementById('addCompanyForm').addEventListener('submit', async (e) => { 
      e.preventDefault(); 
      const name = document.getElementById('companyName').value; 
 
      const res = await fetch('/api/companies', { 
        method: 'POST', 
        headers: { 'Content-Type': 'application/json' }, 
        body: JSON.stringify({ name }) 
      }); 
 
      const data = await res.json(); 
      if (data.success && data.companyId) { 
        window.location.href = `/admin?company=${data.companyId}`; 
      } else { 
        alert(data.message || "Failed to create company."); 
      } 
    }); 
 
    function editCompany(id) { 
      window.location.href = `/admin?company=${id}`; 
    } 
 
    function openAudit(id) { 
      window.location.href = `/audit/${id}`; 
    } 
 
    function logout() { 
      fetch('/auth/logout', { method: 'POST' }).then(() => { 
        window.location.href = '/login'; 
      }); 
    } 
  </script> 
</body> 
</html>
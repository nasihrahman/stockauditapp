<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Stock Audit</title>
  <!-- Add Raleway font -->
  <link href="https://fonts.googleapis.com/css?family=Raleway:400,500,600,700&display=swap" rel="stylesheet">
  
  <link rel="stylesheet" href="/css/indstyle.css">

</head>
<body>
  
 <!-- <header class="header">
  <div class="mobile-menu-icon" onclick="toggleMobileMenu()">
  &#x22EE; Unicode for vertical three dots -->
<!-- </div> -->

<!-- Dropdown Menu -->
<!-- <div id="mobileDropdown" class="mobile-dropdown hidden">
  <a href="/dashboard">Dashboard</a>
  <a href="editCompany(')">Admin</a>
</div> --> 
  <div class="header-content">

    <!-- Left: Logo & Info -->
    <div class="company-section">
      <div class="logo">
        <img src="/images/logo.png" alt="Company Logo" />
      </div>
      <div class="company-info">
        <h1>Food Safety Auditing</h1>
        <p>Company Audit Portal</p>
      </div>
    </div>

    <!-- Right: Buttons + Score -->
    <div class="score-section">
      <div class="button-group">
        <a href="/" class="header-btn">Dashboard</a>
        <button onclick="editCompany('<%= company._id %>')" class="header-btn">Admin</button>
      </div>

      <!-- Score Card -->
      <div class="total-score">
        <h2>Total Score</h2>
        <span class="score-badge" id="totalScore">3</span>
        <div class="score-details" id="totalScoreDetails">3 / 3 (100%)</div>
      </div>
    </div>

  </div>
</header>



  <div class="panels-container">
    
      
  <div class="info-panel">
  <div class="info-grid">
    <div class="info-item"><span class="info-label">Company:</span> <span class="info-value" name="company" ></span></div>
    <div class="info-item"><span class="info-label">Location:</span> <span class="info-value" name="location" ></span></div>
    <div class="info-item"><span class="info-label">Date:</span> <span class="info-value" name="date"></span></div>
    <div class="info-item"><span class="info-label">Branch:</span> <span class="info-value" name="branch"></span></div>
    <div class="info-item"><span class="info-label">Manager:</span> <span class="info-value" name="manager"></span></div>
    <div class="info-item"><span class="info-label">Inspector:</span> <span class="info-value" name="inspector"></span></div>
  </div>
  <button id="toggle-edit-btn"  style="margin-top:20px;">Edit info</button>
</div>
      

  
 <div class="summary-panel">
      <h4 class="summary-title">
        <i class="fas fa-chart-bar me-2"></i>
        Quick Summary
      </h4>
      <div class="table-responsive">
        <table class="table table-hover summary-table" id="summaryTable">
          <thead>
            <tr>
              <th>Category</th>
              <th>Score</th>
              <th>Percentage</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody id="summaryTableBody">
            <!-- Dynamic rows will be inserted here -->
          </tbody>
        </table>
      </div>
    </div>
</div>
  <div class="main-container">
    <main>
      <% if (categories && categories.length) { %>
        <% categories.forEach(function(cat) { %>
          <div class="category-card" data-category-id="<%= cat._id %>">
            <div class="category-header">
              <div class="category-title">
                <%= cat.name %>
                <span class="category-score-badge category-score" data-category-id="<%= cat._id %>">0/0 (0%)</span>
              </div>
            </div>
            <ul class="questions-list">
              <% questions.filter(q => q.category && q.category._id.toString() === cat._id.toString()).forEach(function(q, idx) { %>
                <li class="question-item" data-category-id="<%= cat._id %>" data-question-id="<%= q._id %>">
                  <form method="POST" action="/audit/answer/<%= q._id %>" enctype="multipart/form-data" class="question-form">
                    <div class="question-content">
                      <div class="question-text"><%= idx + 1 %>. <%= q.text %></div>
                      <div class="question-controls">
                        <div class="radio-group">
                          <div class="radio-option">
                            <input type="radio" name="response-<%= q._id %>" value="yes" id="<%= q._id %>-yes" data-score="1">
                            <label for="<%= q._id %>-yes">Yes</label>
                          </div>
                          <div class="radio-option">
                            <input type="radio" name="response-<%= q._id %>" value="no" id="<%= q._id %>-no" data-score="0">
                            <label for="<%= q._id %>-no">No</label>
                          </div>
                          <div class="radio-option">
                            <input type="radio" name="response-<%= q._id %>" value="na" id="<%= q._id %>-na" data-score="0">
                            <label for="<%= q._id %>-na">N/A</label>
                          </div>
                        </div>
                        <!-- New wrapper for Add Image + Score Badge -->
                          <div class="question-footer">
                            <!-- <label class="add-image-label">
                              üì∑ Add image
                              <input type="file" name="images" class="hidden-file-input" accept="image/*">
                            </label> -->
                                <button type="button" class="open-image-options" data-question-id="<%= q._id %>">
                                  üì∑ Add image
                                </button>
                            <span class="question-score-badge" data-question-id="<%= q._id %>">0</span>
                          </div>
                        </div>
                    </div>
                    <input type="text" class="comment-input" placeholder="Add your comments here..." name="comment" autocomplete="off">
                    <!-- <button type="button" class="clear-comment-btn" data-question-id="<%= q._id %>">‚ùå Clear Comment</button> -->

                    <div class="image-preview" data-question-id="<%= q._id %>"></div>
                  </form>
                </li>
              <% }) %>
            </ul>
          </div>
        <% }) %>
      <% } else { %>
        <div class="no-questions">
          <h3>No audit questions available</h3>
          <p>Please add categories and questions to get started.</p>
          <a href="/admin" class="admin-link">Go to Admin Panel</a>
        </div>
      <% } %>
    </main>
    <!-- üì∑ Image Upload Modal -->
<div id="imageOptionModal" class="image-modal-overlay">
  <div class="image-modal-box">
    <h4>Select Image Option</h4>
    <button id="uploadFileBtn">üìÅ Upload from device</button>
    <button id="captureCameraBtn">üì∑ Capture from camera</button>
    <input type="file" id="hiddenImageInput" class="hidden" accept="image/*" capture="environment">
    <button id="closeImageModal">Cancel</button>
  </div>
</div>

  </div>

  <div id="imageModal" class="image-modal">
    <div class="image-modal-content">
      <button class="image-modal-close" id="closeModalBtn">&times;</button>

      <img src="" alt="Preview" class="image-modal-img" id="imageModalImg">
    </div>
  </div>
<div class="action-buttons">
    <button id="clearAllBtn">üóëÔ∏è Clear All</button>
    <button id="exportPdfBtn">üìÑ Save & Export PDF</button>
</div>
<button id="scrollTopBtn" title="Go to top">
  ‚Üë
</button>


<script src="/scripts/index.js"></script>
 <script>
  const scrollTopBtn = document.getElementById("scrollTopBtn");

  // Show button after scrolling down
  window.addEventListener("scroll", () => {
    if (window.scrollY > 300) {
      scrollTopBtn.classList.add("show");
    } else {
      scrollTopBtn.classList.remove("show");
    }
  });

  // Scroll to top when button is clicked
  scrollTopBtn.addEventListener("click", () => {
    window.scrollTo({ top: 0, behavior: "smooth" });
  });
</script>

 </body>
 </html>